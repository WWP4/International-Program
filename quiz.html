<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Legacy Builders — 2-Minute Quiz</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700;800&family=Inter:wght@500;700;800&display=swap" rel="stylesheet">
<!-- AOS -->
<link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css">

<style>
:root{
  --blue:#0e2a47; --blue2:#0c213c; --ink:#1b2434; --muted:#4a648d;
  --line:#e6ecf7; --accent:#c6aa6a; --light:#f7faff;
  --shadow-sm:0 10px 24px rgba(0,0,0,.06); --shadow-lg:0 30px 60px rgba(0,0,0,.20);
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--ink);background:#fff;line-height:1.6}
a{text-decoration:none;color:#365e9e}
.wrap{width:min(900px,92vw);margin:36px auto}

/* Header */
.head{text-align:center;margin-bottom:16px}
.eyebrow{letter-spacing:.16em;text-transform:uppercase;font-weight:800;font-size:.82rem;color:#6c82a8;margin-bottom:6px}
.title{font-family:"Cormorant Garamond",serif;font-weight:800;font-size:clamp(2rem,3vw,2.6rem);color:var(--blue)}
.lead{max-width:70ch;margin:8px auto 0;color:#455b7f}

/* Card shell */
.card{margin-top:18px;border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow-sm);overflow:hidden}
.bar{height:6px;background:#edf2fe;position:relative}
.bar>span{position:absolute;left:0;top:0;height:100%;width:0;background:linear-gradient(90deg,var(--blue),#4c6aa3);transition:width .5s ease}

/* Steps */
.quiz{padding:18px}
.step{display:none;animation:slideIn .32s ease both}
.step.active{display:block}
@keyframes slideIn{from{transform:translateY(8px);opacity:0}to{transform:none;opacity:1}}

.grid{display:grid;gap:14px;grid-template-columns:1fr 1fr}
@media(max-width:720px){.grid{grid-template-columns:1fr}}
label{font-weight:800;font-size:.92rem;color:#21406a}
input[type="text"],input[type="email"],input[type="tel"],select,textarea{
  width:100%;padding:12px 12px;border:1px solid #d7e3f7;border-radius:12px;background:#fff;font:inherit;color:var(--blue)
}
textarea{min-height:110px;resize:vertical}
.help{font-size:.86rem;color:#6a7da1}

/* Chips */
.chips{display:flex;flex-wrap:wrap;gap:10px}
.chip{display:inline-flex;gap:8px;align-items:center;border:1px solid #dbe6ff;background:#f7fbff;color:#21406a;padding:8px 12px;border-radius:999px;font-weight:700}
.chip input{accent-color:#21406a}

/* Nav */
.nav{display:flex;gap:10px;justify-content:space-between;margin-top:16px}
.btn{appearance:none;border:0;cursor:pointer;font-weight:800;letter-spacing:.2px;border-radius:12px;padding:12px 18px}
.btn--ghost{background:#fff;color:var(--blue);border:1px solid var(--line)}
.btn--ghost:hover{background:#f9fbff}
.btn--primary{background:var(--blue);color:#fff;box-shadow:0 16px 32px rgba(2,15,30,.15)}
.btn--primary:hover{background:#173b61}
.btn[disabled]{opacity:.6;pointer-events:none}

/* Success */
.success{display:none;text-align:center;padding:28px 20px}
.success.show{display:block}
.succ__card{background:var(--light);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow-sm);padding:22px 18px;margin-top:12px}
.succ__title{font-family:"Cormorant Garamond",serif;font-weight:800;font-size:1.6rem;color:var(--blue);margin-bottom:6px}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .bar>span{transition:none}
  .step{animation:none}
  [data-aos]{opacity:1 !important;transform:none !important;transition:none !important}
}
</style>
</head>
<body>

<main class="wrap">
  <header class="head" data-aos="fade-up">
    <p class="eyebrow">2-Minute Quiz</p>
    <h1 class="title">Find Your Fastest Path to Launch</h1>
    <p class="lead">Answer a few quick questions. We’ll map the exact next steps to get your program board-approved and recruiting on time.</p>
  </header>

  <section class="card" aria-label="Quick quiz">
    <div class="bar" aria-hidden="true"><span id="progress"></span></div>

    <form id="quizForm" class="quiz" novalidate>
      <!-- STEP 1 -->
      <section class="step active" data-step="1" data-aos="fade-up">
        <div class="grid">
          <div>
            <label for="name">Your name</label>
            <input id="name" name="name" type="text" placeholder="Full name" required>
          </div>
          <div>
            <label for="email">Work email</label>
            <input id="email" name="email" type="email" placeholder="name@school.org" required>
          </div>
          <div>
            <label for="school">School</label>
            <input id="school" name="school" type="text" placeholder="School name" required>
          </div>
          <div>
            <label for="role">Your role</label>
            <select id="role" name="role" required>
              <option value="">Select…</option>
              <option>Head of School</option>
              <option>Principal</option>
              <option>Admissions</option>
              <option>Board Member</option>
              <option>Other</option>
            </select>
          </div>
        </div>
        <p class="help">We’ll send your tailored plan to this email.</p>
        <div class="nav">
          <button type="button" class="btn btn--ghost" disabled>Back</button>
          <button type="button" class="btn btn--primary" id="next1">Next</button>
        </div>
      </section>

      <!-- STEP 2 -->
      <section class="step" data-step="2" data-aos="fade-up">
        <div class="grid">
          <div>
            <label>Primary goal</label>
            <div class="chips">
              <label class="chip"><input type="checkbox" name="goal" value="Recruiting"> Recruiting</label>
              <label class="chip"><input type="checkbox" name="goal" value="Raises"> Fund teacher raises</label>
              <label class="chip"><input type="checkbox" name="goal" value="Culture"> Protect culture</label>
            </div>
          </div>
          <div>
            <label>Target launch window</label>
            <select name="launch_window" required>
              <option value="">Select…</option>
              <option>Next 90 days</option>
              <option>Next 6 months</option>
              <option>This school year</option>
              <option>Next school year</option>
            </select>
          </div>
        </div>
        <div class="grid">
          <div>
            <label>Estimated international cohort size</label>
            <select name="cohort" required>
              <option value="">Select…</option>
              <option>5–10</option>
              <option>10–15</option>
              <option>15–25</option>
              <option>25+</option>
            </select>
          </div>
          <div>
            <label>Do you already have host families?</label>
            <select name="hosts" required>
              <option value="">Select…</option>
              <option>Yes — ready list</option>
              <option>Some — need more</option>
              <option>No — need to recruit</option>
            </select>
          </div>
        </div>
        <div class="nav">
          <button type="button" class="btn btn--ghost" id="back2">Back</button>
          <button type="button" class="btn btn--primary" id="next2">Next</button>
        </div>
      </section>

      <!-- STEP 3 -->
      <section class="step" data-step="3" data-aos="fade-up">
        <div class="grid">
          <div>
            <label for="concern">Biggest concern</label>
            <select id="concern" name="concern" required>
              <option value="">Select…</option>
              <option>Compliance & risk</option>
              <option>Recruiting & agents</option>
              <option>ESL & student supports</option>
              <option>Budget & timing</option>
            </select>
          </div>
          <div>
            <label for="timeframe">When would you like to start?</label>
            <select id="timeframe" name="timeframe" required>
              <option value="">Select…</option>
              <option>Immediately</option>
              <option>Within 30 days</option>
              <option>60–90 days</option>
              <option>Undecided</option>
            </select>
          </div>
        </div>
        <div>
          <label for="notes">Anything else we should know?</label>
          <textarea id="notes" name="notes" placeholder="Optional"></textarea>
        </div>
        <div class="nav">
          <button type="button" class="btn btn--ghost" id="back3">Back</button>
          <button type="submit" class="btn btn--primary" id="submitBtn">Submit Quiz</button>
        </div>
      </section>
    </form>

    <!-- Success -->
    <div id="success" class="success" aria-live="polite">
      <h2 class="succ__title">Thank you — we’re on it.</h2>
      <div class="succ__card">
        We’ll send your tailored next steps to your email. Want to move now?
        <div style="margin-top:10px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
          <a class="btn btn--primary" href="https://calendly.com/melissa-cnu/30min" target="_blank" rel="noopener">Book a Call</a>
          <a class="btn btn--ghost" href="https://buy.stripe.com/fZu8wPdJX6QO0fQ6Cw8so00" target="_blank" rel="noopener">Place Deposit</a>
        </div>
      </div>
      <div class="mini"><span class="pill">White-Glove Partnership</span><span class="pill">Board-Ready</span><span class="pill">Visa-Aligned</span></div>
    </div>
  </section>
</main>

<!-- AOS JS -->
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js" defer></script>
<!-- Supabase JS -->
<script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>

<script>
  // ---------- AOS init
  window.addEventListener('load', function () {
    if (!window.AOS) return;
    const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    AOS.init({ duration: reduced ? 0 : 900, easing: 'ease', offset: 80, once: true, disable: reduced });
  });

  // ---------- Simple stepper
  const steps = Array.from(document.querySelectorAll('.step'));
  const prog  = document.getElementById('progress');
  let i = 0;
  const setStep = (n) => {
    i = Math.max(0, Math.min(n, steps.length-1));
    steps.forEach((s, idx) => s.classList.toggle('active', idx === i));
    prog.style.width = ((i+1)/steps.length*100) + '%';
    window.scrollTo({top: document.querySelector('.card').offsetTop - 24, behavior:'smooth'});
  };
  document.getElementById('next1').addEventListener('click', () => {
    // quick validation for step 1
    const ok = ['name','email','school','role'].every(id => document.getElementById(id).checkValidity());
    if(!ok){ document.getElementById('quizForm').reportValidity(); return; }
    setStep(1);
  });
  document.getElementById('back2').addEventListener('click', () => setStep(0));
  document.getElementById('next2').addEventListener('click', () => {
    const f = document.getElementById('quizForm');
    const ok = f.querySelector('select[name="launch_window"]').checkValidity()
              && f.querySelector('select[name="cohort"]').checkValidity()
              && f.querySelector('select[name="hosts"]').checkValidity();
    if(!ok){ f.reportValidity(); return; }
    setStep(2);
  });
  document.getElementById('back3').addEventListener('click', () => setStep(1));

  // ---------- Supabase client
  const SUPABASE_URL = "https://gdwodqwhjrksjhxazuio.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdkd29kcXdoanJrc2poeGF6dWlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzMTU3NzcsImV4cCI6MjA2Njg5MTc3N30.Zq0lZRK6X6vVVwdhqkNVwMLsGPOhDFrYoEyUwtkbG0o"; // <- paste your real anon key here
  const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // ---------- UTM capture (stored with submission)
  const qp = new URLSearchParams(location.search);
  const utms = {
    utm_source:  qp.get('utm_source')  || null,
    utm_medium:  qp.get('utm_medium')  || null,
    utm_campaign:qp.get('utm_campaign')|| null,
    utm_content: qp.get('utm_content') || null,
    utm_term:    qp.get('utm_term')    || null,
    origin_url:  location.href
  };

  // ---------- Submit
  const form = document.getElementById('quizForm');
  const submitBtn = document.getElementById('submitBtn');
  const success = document.getElementById('success');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    submitBtn.disabled = true; submitBtn.textContent = 'Submitting…';

    // Gather values
    const data = new FormData(form);
    const goals = Array.from(form.querySelectorAll('input[name="goal"]:checked')).map(i => i.value);

    const payload = {
      name:        data.get('name') || null,
      email:       data.get('email') || null,
      school:      data.get('school') || null,
      role:        data.get('role') || null,
      goals, // array<string>
      launch_window: data.get('launch_window') || null,
      cohort:        data.get('cohort') || null,
      hosts:         data.get('hosts') || null,
      concern:       data.get('concern') || null,
      timeframe:     data.get('timeframe') || null,
      notes:         data.get('notes') || null,
      ...utms
    };

    try{
      const { error } = await supabaseClient
        .from('quiz_submissions')
        .insert(payload);

      if(error) throw error;

      // Success UI
      document.querySelector('.card').style.display = 'none';
      success.classList.add('show');
    }catch(err){
      alert('Submission failed. Please try again or email melissa@grantlegacybuilders.com');
      console.error(err);
      submitBtn.disabled = false; submitBtn.textContent = 'Submit Quiz';
    }
  });

  // init progress
  setStep(0);
</script>
</body>
</html>
