<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Legacy Builders — 2-Minute Launch Quiz</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700;800&family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<!-- AOS CSS (optional; your JS can init it) -->
<link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css">

<style>
/* ====== Core Theme ====== */
:root{
  --blue:#0e2a47;        /* brand base */
  --blue-2:#173b61;      /* hover/dark */
  --ink:#1b2434;         /* body text */
  --muted:#62779c;       /* secondary text */
  --line:#e6ecf7;        /* borders */
  --accent:#c6aa6a;      /* subtle gold accent */
  --light:#f7faff;       /* light bg */
  --chip:#f2f7ff;        /* chip bg */
  --shadow-sm:0 10px 24px rgba(2,15,30,.08);
  --shadow-md:0 18px 48px rgba(2,15,30,.12);
  --radius:16px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:var(--ink);
  background:#fff;
  line-height:1.6;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
a{color:#365e9e;text-decoration:none}

/* ====== Layout ====== */
.wrap{width:min(920px,92vw);margin:40px auto}

/* ====== Header ====== */
.head{text-align:center;margin-bottom:18px}
.eyebrow{
  letter-spacing:.16em;text-transform:uppercase;font-weight:800;
  font-size:.82rem;color:#6e86ad;margin-bottom:8px
}
.title{
  font-family:"Cormorant Garamond",serif;
  font-weight:800;line-height:1.15;
  font-size:clamp(2rem,3.2vw,2.7rem);color:var(--blue);margin:0
}
.lead{max-width:70ch;margin:10px auto 0;color:#465f86}
.help{font-size:.88rem;color:var(--muted)}

/* header accent line */
.head::after{
  content:"";display:block;width:84px;height:3px;border-radius:2px;
  background:linear-gradient(90deg,var(--accent),transparent);
  margin:16px auto 0;opacity:.6
}

/* ====== Card ====== */
.card{
  margin-top:22px;background:#fff;border:1px solid var(--line);
  border-radius:var(--radius);box-shadow:var(--shadow-sm);overflow:hidden
}

/* Progress bar */
.bar{height:6px;background:#eef3ff;position:relative}
.bar>span{
  position:absolute;left:0;top:0;height:100%;width:0;
  background:linear-gradient(90deg,var(--blue),#4c6aa3);
  transition:width .45s ease
}

/* ====== Quiz ====== */
.quiz{padding:20px 18px 22px}
.step{display:none;animation:fadeSlide .32s ease both}
.step.active{display:block}
@keyframes fadeSlide{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

.grid{display:grid;gap:14px;grid-template-columns:1fr 1fr}
@media (max-width:720px){.grid{grid-template-columns:1fr}}

/* Labels & Inputs */
label{display:block;font-weight:800;font-size:.94rem;color:#21406a;margin-bottom:6px}
input[type="text"],input[type="email"],select,textarea{
  width:100%;padding:12px 12px;border:1px solid #d7e3f7;border-radius:12px;
  background:#fff;font:inherit;color:var(--blue);outline:none;
  transition:border-color .2s ease, box-shadow .2s ease
}
textarea{min-height:110px;resize:vertical}
input:focus,select:focus,textarea:focus{
  border-color:#8fb1ff;
  box-shadow:0 0 0 4px rgba(79,120,201,.12)
}

/* Chips */
.chips{display:flex;flex-wrap:wrap;gap:10px}
.chip{
  display:inline-flex;gap:8px;align-items:center;
  border:1px solid #dbe6ff;background:var(--chip);color:#21406a;
  padding:8px 12px;border-radius:999px;font-weight:700;cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease
}
.chip:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(11,18,32,.08)}
.chip input{accent-color:#21406a}

/* Nav buttons */
.nav{display:flex;gap:10px;justify-content:space-between;margin-top:18px}
.btn{
  appearance:none;border:0;cursor:pointer;font-weight:800;letter-spacing:.2px;
  border-radius:12px;padding:12px 18px;line-height:1;transition:transform .12s ease, box-shadow .2s ease, background .2s ease
}
.btn--ghost{background:#fff;color:var(--blue);border:1px solid var(--line)}
.btn--ghost:hover{background:#f7fbff}
.btn--primary{background:var(--blue);color:#fff;box-shadow:0 14px 30px rgba(2,15,30,.14)}
.btn--primary:hover{background:var(--blue-2);transform:translateY(-1px);box-shadow:0 18px 40px rgba(2,15,30,.18)}
.btn[disabled]{opacity:.6;pointer-events:none}

/* Focus-visible ring for a11y */
.btn:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible{
  outline:3px solid rgba(79,120,201,.28);outline-offset:2px
}

/* ====== Success State ====== */
.success{display:none;text-align:center;padding:28px 20px}
.success.show{display:block}
.succ__title{
  font-family:"Cormorant Garamond",serif;font-weight:800;
  font-size:1.7rem;color:var(--blue);margin:0 0 8px
}
.succ__card{
  background:var(--light);border:1px solid var(--line);
  border-radius:var(--radius);box-shadow:var(--shadow-md);
  padding:22px 18px;margin-top:12px
}

/* AOS safety */
[data-aos]{will-change:transform,opacity}
@media (prefers-reduced-motion: reduce){
  .step{animation:none}
  .bar>span{transition:none}
  .btn{transition:none}
  [data-aos]{opacity:1 !important;transform:none !important;transition:none !important}
}

/* Mobile spacing polish */
@media (max-width:480px){
  .wrap{margin:28px auto}
  .quiz{padding:16px}
  .nav{gap:8px}
}
</style>
</head>
<body>

<main class="wrap">
  <!-- Header -->
  <header class="head" data-aos="fade-up">
    <p class="eyebrow">Revenue • Enrollment • Global Impact</p>
    <h1 class="title">See How Much New Tuition Your School Could Earn This Year</h1>
    <p class="lead">
      Take this 2-minute quiz to get a <strong>custom revenue forecast</strong>, a <strong>board-ready launch plan</strong>, and clear next steps.
      Instant results delivered to your inbox.
    </p>
    <p class="help" style="margin-top:6px">Trusted by schools for 20+ years • Visa-aligned • Board-approved frameworks</p>
  </header>

  <!-- Quiz Card -->
  <section class="card" aria-label="Quick quiz">
    <div class="bar" aria-hidden="true"><span id="progress"></span></div>

    <form id="quizForm" class="quiz" novalidate>
      <!-- STEP 1 -->
      <section class="step active" data-step="1" data-aos="fade-up" aria-labelledby="step1-title">
        <p class="help">Step 1 of 3 — Contact & Role</p>
        <div class="grid" style="margin-top:6px">
          <div>
            <label for="name">Your name</label>
            <input id="name" name="name" type="text" placeholder="Full name" required>
          </div>
          <div>
            <label for="email">Work email</label>
            <input id="email" name="email" type="email" placeholder="name@school.org" required>
          </div>
          <div>
            <label for="school">School</label>
            <input id="school" name="school" type="text" placeholder="School name" required>
          </div>
          <div>
            <label for="role">Your role</label>
            <select id="role" name="role" required>
              <option value="">Select…</option>
              <option>Head of School</option>
              <option>Principal</option>
              <option>Admissions</option>
              <option>Board Member</option>
              <option>Other</option>
            </select>
          </div>
        </div>
        <p class="help">We’ll email your personalized plan immediately after you finish.</p>
        <div class="nav">
          <button type="button" class="btn btn--ghost" disabled>Back</button>
          <button type="button" class="btn btn--primary" id="next1">Continue</button>
        </div>
      </section>

      <!-- STEP 2 -->
      <section class="step" data-step="2" data-aos="fade-up" aria-labelledby="step2-title">
        <p class="help">Step 2 of 3 — Goals & Timing</p>
        <div class="grid" style="margin-top:6px">
          <div>
            <label>Primary goals</label>
            <div class="chips">
              <label class="chip"><input type="checkbox" name="goal" value="Board approval"> Board approval</label>
              <label class="chip"><input type="checkbox" name="goal" value="Recruiting"> Recruiting</label>
              <label class="chip"><input type="checkbox" name="goal" value="Raises"> Fund teacher raises</label>
              <label class="chip"><input type="checkbox" name="goal" value="Culture"> Protect culture</label>
            </div>
          </div>
          <div>
            <label>Target launch window</label>
            <select name="launch_window" required>
              <option value="">Select…</option>
              <option>Next 90 days</option>
              <option>Next 6 months</option>
              <option>This school year</option>
              <option>Next school year</option>
            </select>
          </div>
        </div>
        <div class="grid">
          <div>
            <label>Estimated international cohort size</label>
            <select name="cohort" required>
              <option value="">Select…</option>
              <option>5–10</option>
              <option>10–15</option>
              <option>15–25</option>
              <option>25+</option>
            </select>
          </div>
          <div>
            <label>Do you already have host families?</label>
            <select name="hosts" required>
              <option value="">Select…</option>
              <option>Yes — ready list</option>
              <option>Some — need more</option>
              <option>No — need to recruit</option>
            </select>
          </div>
        </div>
        <div class="nav">
          <button type="button" class="btn btn--ghost" id="back2">Back</button>
          <button type="button" class="btn btn--primary" id="next2">Continue</button>
        </div>
      </section>

      <!-- STEP 3 -->
      <section class="step" data-step="3" data-aos="fade-up" aria-labelledby="step3-title">
        <p class="help">Step 3 of 3 — Risks & Readiness</p>
        <div class="grid" style="margin-top:6px">
          <div>
            <label for="concern">Biggest concern</label>
            <select id="concern" name="concern" required>
              <option value="">Select…</option>
              <option>Compliance & risk</option>
              <option>Recruiting & agents</option>
              <option>ESL & student supports</option>
              <option>Budget & timing</option>
            </select>
          </div>
          <div>
            <label for="timeframe">When would you like to start?</label>
            <select id="timeframe" name="timeframe" required>
              <option value="">Select…</option>
              <option>Immediately</option>
              <option>Within 30 days</option>
              <option>60–90 days</option>
              <option>Undecided</option>
            </select>
          </div>
        </div>
        <div>
          <label for="notes">Anything else we should know?</label>
          <textarea id="notes" name="notes" placeholder="Optional"></textarea>
        </div>
        <div class="nav">
          <button type="button" class="btn btn--ghost" id="back3">Back</button>
          <button type="submit" class="btn btn--primary" id="submitBtn">Get My Plan</button>
        </div>
        <p class="help" style="margin-top:10px">Private and secure. We never share your information.</p>
      </section>
    </form>

    <!-- Success -->
    <div id="success" class="success" aria-live="polite">
      <h2 class="succ__title">Your Preliminary Plan Is Ready</h2>
      <div class="succ__card">
        You’re pre-qualified for our Fall Launch cohort. To secure your onboarding window, choose a next step below.
        <div style="margin-top:12px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
          <a class="btn btn--primary" href="https://calendly.com/melissa-cnu/30min" target="_blank" rel="noopener">Book My Launch Call</a>
          <a class="btn btn--ghost" href="https://buy.stripe.com/fZu8wPdJX6QO0fQ6Cw8so00" target="_blank" rel="noopener">Place Deposit</a>
        </div>
        <p class="help" style="margin-top:10px">You’ll also receive a board-ready one-pager with your revenue forecast and next steps.</p>
      </div>
      <p class="help" style="margin-top:12px">White-Glove Partnership • Board-Ready • Visa-Aligned</p>
    </div>
  </section>
</main>

</body>
</html>


<!-- AOS JS -->
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

<!-- Supabase UMD (must load BEFORE we call createClient) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // ---------- AOS
  if (window.AOS){
    const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    AOS.init({ duration: reduced ? 0 : 900, easing: 'ease', offset: 80, once: true, disable: reduced });
  }

  // Guard: ensure Supabase UMD loaded
  if (!window.supabase) {
    console.error("Supabase UMD failed to load (check the Network tab).");
    // We don't early return, but inserts will fail; this helps you debug quickly.
  }

  // ---------- Supabase client
  const SUPABASE_URL = "https://gdwodqwhjrksjhxazuio.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdkd29kcXdoanJrc2poeGF6dWlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzMTU3NzcsImV4cCI6MjA2Njg5MTc3N30.Zq0lZRK6X6vVVwdhqkNVwMLsGPOhDFrYoEyUwtkbG0o";
  const sb = window.supabase?.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // ---------- Simple stepper
  const steps = Array.from(document.querySelectorAll('.step'));
  const prog  = document.getElementById('progress');
  let idx = 0;
  function setStep(n){
    idx = Math.max(0, Math.min(n, steps.length-1));
    steps.forEach((s,i)=>s.classList.toggle('active', i===idx));
    prog.style.width = ((idx+1)/steps.length*100) + '%';
    const card = document.querySelector('.card');
    if (card) {
      const top = card.offsetTop - 24;
      window.scrollTo({top, behavior:'smooth'});
    }
  }
  document.getElementById('next1').addEventListener('click', ()=>{
    const ok = ['name','email','school','role'].every(id=>document.getElementById(id).checkValidity());
    if(!ok){ document.getElementById('quizForm').reportValidity(); return; }
    setStep(1);
  });
  document.getElementById('back2').addEventListener('click', ()=>setStep(0));
  document.getElementById('next2').addEventListener('click', ()=>{
    const f = document.getElementById('quizForm');
    const ok = f.querySelector('select[name="launch_window"]').checkValidity()
             && f.querySelector('select[name="cohort"]').checkValidity()
             && f.querySelector('select[name="hosts"]').checkValidity();
    if(!ok){ f.reportValidity(); return; }
    setStep(2);
  });
  document.getElementById('back3').addEventListener('click', ()=>setStep(1));

  // ---------- Submit
  const form = document.getElementById('quizForm');
  const submitBtn = document.getElementById('submitBtn');
  const success = document.getElementById('success');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    submitBtn.disabled = true; submitBtn.textContent = 'Submitting…';

    // collect goals
    const goals = Array.from(form.querySelectorAll('input[name="goal"]:checked')).map(i=>i.value);

    const payload = {
      name:        document.getElementById('name').value || null,
      email:       document.getElementById('email').value || null,
      school:      document.getElementById('school').value || null,
      role:        document.getElementById('role').value || null,
      goals, // text[]
      launch_window: form.querySelector('[name="launch_window"]').value || null,
      cohort:        form.querySelector('[name="cohort"]').value || null,
      hosts:         form.querySelector('[name="hosts"]').value || null,
      concern:       document.getElementById('concern').value || null,
      timeframe:     document.getElementById('timeframe').value || null,
      notes:         document.getElementById('notes').value || null,
      origin_url:    location.href,
      utm_source:    new URLSearchParams(location.search).get('utm_source'),
      utm_medium:    new URLSearchParams(location.search).get('utm_medium'),
      utm_campaign:  new URLSearchParams(location.search).get('utm_campaign'),
      utm_content:   new URLSearchParams(location.search).get('utm_content'),
      utm_term:      new URLSearchParams(location.search).get('utm_term')
    };

    try{
      if (!sb) throw new Error("Supabase client not initialized.");
      const { error } = await sb.from('quiz_submissions').insert([payload]); // array insert

      if (error) throw error;

      document.querySelector('.card').style.display = 'none';
      success.classList.add('show');
    }catch(err){
      console.error('Supabase insert error:', err);
      alert('Submission failed. Please try again or email melissa@grantlegacybuilders.com');
      submitBtn.disabled = false; submitBtn.textContent = 'Submit Quiz';
    }
  });

  // init step bar
  setStep(0);
});
</script>
</body>
</html>
